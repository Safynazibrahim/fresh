"use strict";(self.webpackChunkGreenFinity=self.webpackChunkGreenFinity||[]).push([[849],{6849:(q,l,a)=>{a.r(l),a.d(l,{ForegtpasswordComponent:()=>I});var p=a(6814),m=a(1120),r=a(95),e=a(4769),c=a(9862);let u=(()=>{class s{constructor(t){this._HttpClient=t,this.baseUrl="https://ecommerce.routemisr.com/api/v1/auth/"}forgetPassword(t){return this._HttpClient.post(this.baseUrl+"forgotPasswords",t)}resetCode(t){return this._HttpClient.post(this.baseUrl+"verifyResetCode",t)}resetPassword(t){return this._HttpClient.put(this.baseUrl+"resetPassword",t)}static#e=this.\u0275fac=function(o){return new(o||s)(e.LFG(c.eN))};static#t=this.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var d=a(2425);function _(s,i){1&s&&(e.TgZ(0,"p",13),e._uU(1,"Email is required"),e.qZA())}function g(s,i){1&s&&(e.TgZ(0,"p",13),e._uU(1,"Email format is InValid"),e.qZA())}function f(s,i){if(1&s&&(e.TgZ(0,"div",11),e.YNc(1,_,2,0,"p",12),e.YNc(2,g,2,0,"p",12),e.qZA()),2&s){const t=e.oxw(2);let o,n;e.xp6(1),e.Q6J("ngIf",null==(o=t.forgotForm.get("email"))?null:o.getError("required")),e.xp6(1),e.Q6J("ngIf",null==(n=t.forgotForm.get("email"))?null:n.getError("email"))}}function w(s,i){if(1&s&&(e.TgZ(0,"p",14),e._uU(1),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.userMsg,"")}}function x(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"section",1)(1,"h3",2),e._uU(2,"Forget Password"),e.qZA(),e.TgZ(3,"form",3),e.NdJ("ngSubmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.forgetPassword())}),e.TgZ(4,"h6",2),e._uU(5,"We will send you an email to reset your password."),e.qZA(),e.TgZ(6,"div",4)(7,"label",5),e._uU(8,"Email:"),e.qZA(),e._UZ(9,"input",6),e.YNc(10,f,3,2,"div",7),e.TgZ(11,"button",8),e._uU(12,"Submit"),e.qZA(),e.YNc(13,w,2,1,"p",9),e.TgZ(14,"span",10),e._uU(15,"Cancel"),e.qZA()()()()}if(2&s){const t=e.oxw();let o;e.xp6(3),e.Q6J("formGroup",t.forgotForm),e.xp6(7),e.Q6J("ngIf",(null==(o=t.forgotForm.get("email"))?null:o.errors)&&(null==(o=t.forgotForm.get("email"))?null:o.touched)),e.xp6(1),e.Q6J("disabled",t.forgotForm.invalid),e.xp6(2),e.Q6J("ngIf",t.userMsg)}}function h(s,i){1&s&&(e.TgZ(0,"p",13),e._uU(1,"Reset Code is required"),e.qZA())}function C(s,i){if(1&s&&(e.TgZ(0,"div",11),e.YNc(1,h,2,0,"p",12),e.qZA()),2&s){const t=e.oxw(2);let o;e.xp6(1),e.Q6J("ngIf",null==(o=t.resetCodeForm.get("resetCode"))?null:o.getError("required"))}}function F(s,i){if(1&s&&(e.TgZ(0,"p",14),e._uU(1),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.userMsg,"")}}function Z(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"section",1)(1,"h3",2),e._uU(2,"Reset Code"),e.qZA(),e.TgZ(3,"form",3),e.NdJ("ngSubmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.resetCode())}),e.TgZ(4,"h6",2),e._uU(5,"We sent you reset code, Please write it."),e.qZA(),e.TgZ(6,"div",4)(7,"label",15),e._uU(8,"Reset Code:"),e.qZA(),e._UZ(9,"input",16),e.YNc(10,C,2,1,"div",7),e.TgZ(11,"button",8),e._uU(12,"Submit"),e.qZA(),e.YNc(13,F,2,1,"p",9),e.TgZ(14,"span",10),e._uU(15,"Cancel"),e.qZA()()()()}if(2&s){const t=e.oxw();let o;e.xp6(3),e.Q6J("formGroup",t.resetCodeForm),e.xp6(7),e.Q6J("ngIf",(null==(o=t.resetCodeForm.get("resetCode"))?null:o.errors)&&(null==(o=t.resetCodeForm.get("resetCode"))?null:o.touched)),e.xp6(1),e.Q6J("disabled",t.resetCodeForm.invalid),e.xp6(2),e.Q6J("ngIf",t.userMsg)}}function T(s,i){1&s&&(e.TgZ(0,"p",13),e._uU(1,"New Password is required"),e.qZA())}function v(s,i){1&s&&(e.TgZ(0,"p",13),e._uU(1,"New Password must be at least 6 chars"),e.qZA())}function b(s,i){if(1&s&&(e.TgZ(0,"div",11),e.YNc(1,T,2,0,"p",12),e.YNc(2,v,2,0,"p",12),e.qZA()),2&s){const t=e.oxw(2);let o,n;e.xp6(1),e.Q6J("ngIf",null==(o=t.resetPasswordForm.get("newPassword"))?null:o.getError("required")),e.xp6(1),e.Q6J("ngIf",null==(n=t.resetPasswordForm.get("newPassword"))?null:n.getError("pattern"))}}function P(s,i){if(1&s&&(e.TgZ(0,"p",14),e._uU(1),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.userMsg,"")}}function U(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"section",1)(1,"h3",2),e._uU(2,"Reset New Password"),e.qZA(),e.TgZ(3,"form",3),e.NdJ("ngSubmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.resetPassword())}),e.TgZ(4,"h6",2),e._uU(5,"Write your new password."),e.qZA(),e.TgZ(6,"div",4)(7,"label",17),e._uU(8,"New password:"),e.qZA(),e._UZ(9,"input",18),e.YNc(10,b,3,2,"div",7),e.TgZ(11,"button",8),e._uU(12,"Submit"),e.qZA(),e.YNc(13,P,2,1,"p",9),e.TgZ(14,"span",10),e._uU(15,"Cancel"),e.qZA()()()()}if(2&s){const t=e.oxw();let o;e.xp6(3),e.Q6J("formGroup",t.resetPasswordForm),e.xp6(7),e.Q6J("ngIf",(null==(o=t.resetPasswordForm.get("newPassword"))?null:o.errors)&&(null==(o=t.resetPasswordForm.get("newPassword"))?null:o.touched)),e.xp6(1),e.Q6J("disabled",t.resetPasswordForm.invalid),e.xp6(2),e.Q6J("ngIf",t.userMsg)}}let I=(()=>{class s{constructor(t,o,n){this._ForgetpassService=t,this._ToastrService=o,this._Router=n,this.step1=!0,this.step2=!1,this.step3=!1,this.email="",this.userMsg="",this.forgotForm=new r.cw({email:new r.NI("",[r.kI.required,r.kI.email])}),this.resetCodeForm=new r.cw({resetCode:new r.NI("",[r.kI.required])}),this.resetPasswordForm=new r.cw({newPassword:new r.NI("",[r.kI.required,r.kI.pattern(/^[a-zA-Z0-9_@]{6,}$/)])})}forgetPassword(){let t=this.forgotForm.value;this.email=t.email,this._ForgetpassService.forgetPassword(t).subscribe({next:o=>{console.log(o),this._ToastrService.success(o.message),this.step1=!1,this.step2=!0},error:o=>{this.userMsg=o.error.message}})}resetCode(){this._ForgetpassService.resetCode(this.resetCodeForm.value).subscribe({next:o=>{console.log(o),this._ToastrService.success(o.status+" Code"),this.step2=!1,this.step3=!0},error:o=>{this.userMsg=o.error.message}})}resetPassword(){let t=this.resetPasswordForm.value;t.email=this.email,this._ForgetpassService.resetPassword(t).subscribe({next:o=>{console.log("msg",o),o.token&&(localStorage.setItem("_token",o.token),this._Router.navigate(["/home"]))},error:o=>{this.userMsg=o.error.message}})}static#e=this.\u0275fac=function(o){return new(o||s)(e.Y36(u),e.Y36(d._W),e.Y36(m.F0))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-foregtpassword"]],standalone:!0,features:[e.jDz],decls:3,vars:3,consts:[["class","row w-50 mx-auto my-5 shadow rounded p-4",4,"ngIf"],[1,"row","w-50","mx-auto","my-5","shadow","rounded","p-4"],[1,"mb-3"],[3,"formGroup","ngSubmit"],[1,"form-item"],["for","email"],["formControlName","email","type","email","id","email",1,"form-control","mb-4"],["class","mt-1 alert alert-danger p-1 small",4,"ngIf"],[1,"form-control","main-btn","my-4",3,"disabled"],["class","alert alert-danger w-75 mx-auto p-1 mb-0",4,"ngIf"],["role","button","routerLink","/login"],[1,"mt-1","alert","alert-danger","p-1","small"],["class","mb-0",4,"ngIf"],[1,"mb-0"],[1,"alert","alert-danger","w-75","mx-auto","p-1","mb-0"],["for","resetCode"],["formControlName","resetCode","type","text","id","resetCode",1,"form-control","mb-4"],["for","newPassword"],["formControlName","newPassword","type","password","id","newPassword",1,"form-control","mb-4"]],template:function(o,n){1&o&&(e.YNc(0,x,16,4,"section",0),e.YNc(1,Z,16,4,"section",0),e.YNc(2,U,16,4,"section",0)),2&o&&(e.Q6J("ngIf",n.step1),e.xp6(1),e.Q6J("ngIf",n.step2),e.xp6(1),e.Q6J("ngIf",n.step3))},dependencies:[p.ez,p.O5,m.rH,r.UX,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u]})}return s})()}}]);